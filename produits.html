<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CBK Design â€” Gestion des Produits</title>

  <style>
    :root{
      --brand:#0ea5a4;
      --dark:#0b1220;
      --muted:#6b7280;
      --card:#fff;
      --radius:12px;
    }
    body{
      margin:0; padding:0;
      font-family:Inter,Arial;
      background:#f4f6f8;
      color:var(--dark);
    }

    header{
      background:var(--brand);
      color:white;
      padding:20px;
      font-size:22px;
      font-weight:700;
      text-align:center;
    }

    .container{
      max-width:1100px;
      margin:30px auto;
      background:white;
      padding:20px;
      border-radius:var(--radius);
      box-shadow:0 8px 24px rgba(0,0,0,0.08);
    }

    .top-actions{
      display:flex;
      justify-content:space-between;
      margin-bottom:20px;
    }

    button{
      padding:10px 16px;
      border:none;
      border-radius:var(--radius);
      cursor:pointer;
      font-weight:600;
    }
    .btn-primary{
      background:var(--brand);
      color:white;
    }
    .btn-edit{ background:#3b82f6; color:white; }
    .btn-delete{ background:#ef4444; color:white; }

    table{
      width:100%;
      border-collapse:collapse;
      margin-top:10px;
    }
    th,td{
      padding:12px;
      border-bottom:1px solid #ddd;
      text-align:left;
    }
    th{
      background:#f7faf9;
      font-weight:700;
    }

    /* Modal */
    .modal{
      position:fixed;
      top:0; left:0;
      width:100%; height:100%;
      background:rgba(0,0,0,0.45);
      display:none;
      align-items:center;
      justify-content:center;
      padding:20px;
    }
    .modal-content{
      background:white;
      padding:20px;
      border-radius:var(--radius);
      width:100%; max-width:450px;
      box-shadow:0 4px 20px rgba(0,0,0,0.1);
      animation:fadeIn .3s;
    }
    @keyframes fadeIn {
      from{opacity:0; transform:scale(.95);}
      to{opacity:1; transform:scale(1);}
    }

    input{
      width:100%;
      padding:10px;
      margin:8px 0 14px 0;
      border:1px solid #ddd;
      border-radius:var(--radius);
    }
  </style>
</head>
<body>

<header>ðŸ“¦ CBK Design Administration â€” Gestion des Produits</header>

<div class="container">

  <div class="top-actions">
    <h2>Liste des produits</h2>
    <button class="btn-primary" onclick="openAddModal()">+ Ajouter un produit</button>
  </div>

  <table id="productTable">
    <thead>
      <tr>
        <th>ID</th>
        <th>Nom</th>
        <th>Prix</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <!-- DonnÃ©es initiales -->
      <tr>
        <td>1</td><td>Site Vitrine</td><td>150$</td>
        <td>
          <button class="btn-edit" onclick="openEditModal(this)">Modifier</button>
          <button class="btn-delete" onclick="deleteProduct(this)">Supprimer</button>
        </td>
      </tr>
      <tr>
        <td>2</td><td>Boutique en ligne</td><td>250$</td>
        <td>
          <button class="btn-edit" onclick="openEditModal(this)">Modifier</button>
          <button class="btn-delete" onclick="deleteProduct(this)">Supprimer</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- MODAL Ajouter / Modifier -->
<div class="modal" id="productModal">
  <div class="modal-content">
    <h3 id="modalTitle">Ajouter un produit</h3>

    <input type="hidden" id="editRow">
    <input type="text" id="productName" placeholder="Nom du produit">
    <input type="text" id="productPrice" placeholder="Prix">

    <button class="btn-primary" onclick="saveProduct()">Enregistrer</button>
    <button onclick="closeModal()" style="margin-left:10px">Annuler</button>
  </div>
</div>

<script>
  const modal = document.getElementById("productModal");
  const productName = document.getElementById("productName");
  const productPrice = document.getElementById("productPrice");
  const editRow = document.getElementById("editRow");
  const modalTitle = document.getElementById("modalTitle");
  const tableBody = document.querySelector("#productTable tbody");

  // Charger les produits depuis localStorage au dÃ©marrage
  function loadProducts(){
    const data = JSON.parse(localStorage.getItem("products") || "[]");
    tableBody.innerHTML = "";

    data.forEach((p, index) => {
      const row = tableBody.insertRow();
      row.innerHTML = `
        <td>${index+1}</td>
        <td>${p.name}</td>
        <td>${p.price}</td>
        <td>
          <button class="btn-edit" onclick="openEditModal(this)">Modifier</button>
          <button class="btn-delete" onclick="deleteProduct(this)">Supprimer</button>
        </td>`;
    });
  }

  // Sauvegarder les produits dans localStorage
  function saveToStorage(){
    const rows = tableBody.querySelectorAll("tr");
    const data = [];

    rows.forEach(r => {
      data.push({
        name: r.cells[1].innerText,
        price: r.cells[2].innerText
      });
    });

    localStorage.setItem("products", JSON.stringify(data));
  }

  function openAddModal(){
    modal.style.display = "flex";
    modalTitle.textContent = "Ajouter un produit";
    editRow.value = "";
    productName.value = "";
    productPrice.value = "";
  }

  function openEditModal(btn){
    const row = btn.parentNode.parentNode;
    editRow.value = row.rowIndex;
    productName.value = row.cells[1].innerText;
    productPrice.value = row.cells[2].innerText;
    modalTitle.textContent = "Modifier le produit";
    modal.style.display = "flex";
  }

  function closeModal(){
    modal.style.display = "none";
  }

  function saveProduct(){
    const name = productName.value.trim();
    const price = productPrice.value.trim();

    if(name === "" || price === ""){
      alert("Veuillez remplir tous les champs");
      return;
    }

    if(editRow.value === ""){
      // Ajouter
      const row = tableBody.insertRow();
      row.innerHTML = `
        <td>${tableBody.rows.length}</td>
        <td>${name}</td>
        <td>${price}</td>
        <td>
          <button class="btn-edit" onclick="openEditModal(this)">Modifier</button>
          <button class="btn-delete" onclick="deleteProduct(this)">Supprimer</button>
        </td>`;
    } else {
      // Modifier
      const row = tableBody.rows[editRow.value - 1];
      row.cells[1].innerText = name;
      row.cells[2].innerText = price;
    }

    saveToStorage();
    closeModal();
  }

  function deleteProduct(btn){
    if(confirm("Supprimer ce produit ?")){
      const row = btn.parentNode.parentNode;
      row.remove();
      saveToStorage();
      loadProducts();
    }
  }

  // Charger donnÃ©es au dÃ©marrage
  loadProducts();
</script>
